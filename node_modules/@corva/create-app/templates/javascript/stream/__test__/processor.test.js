jest.mock('@corva/node-api-client');

const Processor = require('../src/processor');

test('process event', async () => {
  const fakeLogger = console;
  const fakeApiClient = {};

  const processor = new Processor({
    apiClient: fakeApiClient,
    logger: fakeLogger,
  });

  const event = {
    asset_id: 1234,
    app_stream_id: 2345,
    records: [
      {
        company_id: 1,
        asset_id: 1234,
        timestamp: 157829400,
        data: { hole_depth: 1000 },
      },
      {
        company_id: 1,
        asset_id: 1234,
        timestamp: 157829401,
        data: { hole_depth: 1001 },
      },
      {
        company_id: 1,
        asset_id: 1234,
        timestamp: 157829402,
        data: { hole_depth: 1001 },
      },
      {
        company_id: 1,
        asset_id: 1234,
        timestamp: 157829403,
        data: { hole_depth: 1001.5 },
      },
    ],
  };

  await processor.process({ event });
});
