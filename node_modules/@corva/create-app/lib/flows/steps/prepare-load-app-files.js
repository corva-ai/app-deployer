const { loadJson } = require('../lib/json');
const { Manifest } = require('../lib/manifest');

const LOAD_APP_FILES_STEP = {
  message: "Loading Corva app's files...",
  async fn(context) {
    const manifest =
      context.manifest || new Manifest(await loadJson(context.dirName, 'manifest.json'));
    const pkg =
      context.package || (manifest.isJs() && (await loadJson(context.dirName, 'package.json')));

    return { pkg, manifest };
  },
};

module.exports = {
  LOAD_APP_FILES_STEP,
};
