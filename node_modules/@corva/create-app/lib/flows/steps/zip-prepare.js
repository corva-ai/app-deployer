import { logger } from '../../helpers/logger.js';
import { saveJson } from '../lib/json.js';

import debugFn from 'debug';

const debug = debugFn('cca:flow:zip:prepare');

export const PREPARE_FILES_BEFORE_ZIP_STEP = {
  message: 'Preparing...',
  fn: async ({ itemsToSave, dirName }) => {
    for (const item of itemsToSave) {
      debug(`Updating %s`, item.name);
      await saveJson(dirName, item.name, item.content);

      if (item.message) {
        logger.write(item.message);
      }
    }
  },
};
